<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rifa Sammuel Tobar</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        h1 { color: #222; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 10px; }
        .numero {
            padding: 10px;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }
        .disponible { background: #4caf50; color: white; }
        .reservado { background: #f44336; color: white; cursor: not-allowed; }
    </style>
</head>
<body>
    <h1>Rifa Solidaria Club Wolves Candelaria</h1>
    <p>Seleccione un número disponible para reservar.</p>

    <div id="numeros" class="grid"></div>

    <!-- Firebase -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
        import { getFirestore, collection, onSnapshot, doc, updateDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

        // Configuración Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDo3cgRT87JQkV9kgJG2mrPnUkb5HugH9Q",
            authDomain: "rifasammuel.firebaseapp.com",
            projectId: "rifasammuel",
            storageBucket: "rifasammuel.firebasestorage.app",
            messagingSenderId: "707645550462",
            appId: "1:707645550462:web:42735685340fb79e5d8d2f",
            measurementId: "G-W3HY4MHHV4"
        };

        // Inicializar
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        const numerosDiv = document.getElementById("numeros");

        // Escucha en tiempo real de la colección "numeros"
        onSnapshot(collection(db, "numeros"), (snapshot) => {
            numerosDiv.innerHTML = "";
            snapshot.forEach((docSnap) => {
                const data = docSnap.data();
                const numDiv = document.createElement("div");
                numDiv.textContent = data.numero;
                numDiv.classList.add("numero");
                numDiv.classList.add(data.estado === "disponible" ? "disponible" : "reservado");

                if (data.estado === "disponible") {
                    numDiv.addEventListener("click", async () => {
                        if (confirm(`¿Reservar el número ${data.numero}?`)) {
                            await updateDoc(doc(db, "numeros", docSnap.id), {
                                estado: "reservado"
                            });
                            alert(`Número ${data.numero} reservado.`);
                        }
                    });
                }
                numerosDiv.appendChild(numDiv);
            });
        });
    </script>
</body>
</html>
